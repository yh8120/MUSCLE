<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="~{parts/common :: html_head()}"></head>

<body class="bg-dark text-light" style="padding-bottom: 60px;">
    <header th:replace="~{parts/common :: header()}"></header>


    <div class="container main-container">
        <div class="row">
            <div class="col">
                <div class="alert alert-danger" th:if="${message}">[[${message}]]</div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6 col-xl-8">
                <div class="row">
                    <div class="col mt-4">
                        <div class="card bg-dark text-light border-0 ">
                            <h5 class="card-header bg-dark bg-gradient text-center title-logo fs-6">通知</h5>
                            <div class="card-body">
                                <form th:action="@{/training/addProtein}" method="post">
                                    <input type="hidden" th:name="${userId}" th:value="${#authentication.principal.loginUser.id}">
                                    <div class="table-responsive" style="max-height: 200px;">
                                        <table id="conversation" class="table table-dark table-sm table-striped table-hover">
                                            <tbody id="noticeTable">
                                                <template id="noticeRow">
                                                    <tr>
                                                        <th><img class="noticeIcon me-2" style="width: 20px;"></th>
                                                        <td class="text-break">
                                                            <span class="noticeMessage"></span>
                                                        </td>
                                                        <td>
                                                            <img class="noticeButton ms-1 cursor-hand" style="width: 20px;">
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col mt-4">
                        <div class="row">
                            <div class="col-lg-6">
                                <div id="lineChartContainer" class="ratio ratio-4x3">
                                    <canvas id="lineChart"></canvas>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div id="barChartContainer" class="ratio ratio-4x3">
                                    <canvas id="barChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-xl-4 mt-4">
                <div class="card bg-dark text-light justify-content-center border-0">
                    <h5 class="card-header bg-dark bg-gradient text-center title-logo fs-6">トレーニング</h5>
                    <div class="card-body">

                        <ul class="nav  nav-tabs nav-fill border-bottom border-danger border-1">
                            <li th:each="training,status : ${trainingList}" class="nav-item"><a th:href="@{#tabItem__${training.id}__}" class="nav-link link-light"
                                    th:classappend="${status.first}?'active'" data-bs-toggle="tab">[[${training.name}]]</a></li>
                            <li class="nav-item"><a class="nav-link link-light" th:href="@{/training/add}">
                                    <span th:if="${#lists.isEmpty(trainingList)}" class="title-logo me-2">トレーニングを追加</span><img style="width: 30px;" th:src="@{/images/icon/add.png}" alt="追加" />
                                </a></li>
                        </ul>

                        <div th:each="training,status : ${trainingList}" class="tab-content">
                            <div th:id="tabItem__${training.id}__" th:classappend="${status.first}?'active'" class="tab-pane container">
                                <div class="row bg-dark-subtle p-2">

                                    <a th:each="item:${training.trainingList}" th:href="@{/training/log/{id}(id=${item.id})}" class="col-6 mt-3 text-decoration-none">
                                        <div class="card shadow border-0">
                                            <ul class="list-group list-group-flush text-center">
                                                <li class="list-group-item bg-dark bg-gradient">
                                                    <div class="d-flex flex-row justify-content-center">
                                                        <img style="width: 23px;" th:each="i:${#numbers.sequence(1,item.priority.id)}" th:src="@{/images/icon/hot.svg}" alt="★" />
                                                    </div>
                                                </li>
                                                <li class="list-group-item text-truncate bg-dark bg-gradient text-light">[[${item.name}]]</li>
                                                <li class="list-group-item bg-dark bg-gradient text-light " th:text="${item.lastTrainingDay==null?'-':#dates.format(item.lastTrainingDay,'yyyy-MM-dd')}">[[]]</li>
                                            </ul>
                                        </div>
                                    </a>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <footer th:replace="~{parts/common :: footer()}"></footer>
    <th:block th:replace="~{parts/common :: javascripts()}"></th:block>
    <script th:src="@{/webjars/chartjs/4.1.2/dist/chart.umd.js}"></script>
    <script th:src="@{/webjars/sockjs-client/sockjs.min.js}"></script>
    <script th:src="@{/webjars/stomp-websocket/stomp.min.js}"></script>
    <script th:src="@{/js/exampleChart.js}"></script>
    <script th:src="@{/js/webSocket.js}"></script>
</body>
</html>